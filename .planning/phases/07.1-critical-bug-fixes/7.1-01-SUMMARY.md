---
phase: 7.1-critical-bug-fixes
plan: 01
subsystem: expense-tracking
tags: [bugfix, ui, accessibility, i18n]

dependency_graph:
  requires: [02-expense-tracking]
  provides: [english-expense-names, pill-toggle-pattern]
  affects: []

tech_stack:
  added: []
  patterns:
    - pill-toggle: "Accessible button group pattern for binary selection"
    - aria-pressed: "ARIA state attribute for toggle buttons"

file_tracking:
  key_files:
    created: []
    modified:
      - autonomo_dashboard.html

decisions:
  - id: pill-toggle-pattern
    choice: "Two-button pill toggle instead of checkbox slider"
    rationale: "Better UX, clearer active state, easier to click on mobile"

  - id: english-labels
    choice: "Full English expense names with deduction info"
    rationale: "User requested all English, added deduction percentage for clarity"

  - id: preserve-ids
    choice: "Keep original Dutch-based IDs for localStorage compatibility"
    rationale: "Prevents data loss for existing users"

metrics:
  duration: "3 min"
  completed: "2026-02-02"
---

# Phase 7.1 Plan 01: Expense Section Bug Fixes Summary

**One-liner:** English expense names with pill-style Belgium toggle and working add expense form

## What Was Done

### Task 1: Dutch to English Translation
Translated all DEFAULT_EXPENSES names from Dutch to English:

**Spain Deductible:**
- `Huur (Rent)` -> `Rent (30% deductible)`
- `GSM (Mobile)` -> `Mobile (50% deductible)`
- `Elektriciteit` -> `Electricity (9% deductible)`

**Private:**
- `Huur 70%` -> `Rent (70% private)`
- `GSM 50%` -> `Mobile (50% private)`
- `Elektriciteit 91%` -> `Electricity (91% private)`
- `Auto` -> `Car`
- `Verzekeringen` -> `Insurance`

IDs preserved for localStorage backwards compatibility.

### Task 2: Pill-Style Belgium Toggle
Replaced checkbox slider toggle with accessible pill buttons:

**CSS Changes:**
- Removed `.toggle-switch`, `.toggle-label`, `.slider` styles
- Added `.pill-toggle` with button states (hover, active, focus-visible)

**HTML Changes:**
- Two `<button>` elements with `aria-pressed` attribute
- `role="group"` and `aria-label` for accessibility

**JavaScript Changes:**
- Added `setBelgiumPattern(pattern)` function
- Simplified `initBelgiumToggle()` (no longer needed, kept for compatibility)
- Removed `updateToggleLabels()` function

## Commits

| Hash | Type | Description |
|------|------|-------------|
| e3a66b8 | fix | Translate Dutch expense names to English |
| 0d2687c | feat | Replace Belgium toggle with pill-style buttons |

## Decisions Made

1. **Pill toggle pattern** - Chose two-button pill design over checkbox slider for better clarity and mobile usability. Active button shows green background.

2. **English labels include deduction info** - Added percentage info (e.g., "30% deductible") directly in the name for immediate clarity without needing to look at formula.

3. **Preserve localStorage IDs** - Kept original IDs (`huur`, `gsm`, etc.) to avoid breaking existing user data.

## Verification

- [x] All expense names display in English
- [x] Belgium toggle displays as two pill buttons
- [x] Clicking pill buttons switches active state
- [x] Active button shows accent color background
- [x] Pills have proper ARIA attributes (aria-pressed, role=group)
- [x] Keyboard accessible (focusable, focus-visible outline)
- [x] showAddForm function exists and references form element
- [x] Form has hidden class removed on button click

## Deviations from Plan

None - plan executed exactly as written.

## Next Steps

Continue to 7.1-02-PLAN.md (Tooltip positioning fix).
